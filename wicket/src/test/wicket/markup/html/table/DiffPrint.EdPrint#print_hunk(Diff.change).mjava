        /**
         * Print a hunk of an ed diff.
         * @param hunk
         */
        protected void print_hunk(Diff.change hunk)
        {

            /* Determine range of line numbers involved in each file. */
            analyze_hunk(hunk);
            if (deletes == 0 && inserts == 0)
                return;

            /* Print out the line number header for this hunk */
            print_number_range(',', first0, last0);
            outfile.println(change_letter(inserts, deletes));

            /* Print new/changed lines from second file, if needed */
            if (inserts != 0)
            {
                boolean inserting = true;
                for (int i = first1; i <= last1; i++)
                {
                    /* Resume the insert, if we stopped. */
                    if (!inserting)
                        outfile.println(i - first1 + first0 + "a");
                    inserting = true;

                    /*
                     * If the file's line is just a dot, it would confuse `ed'.
                     * So output it with a double dot, and set the flag
                     * LEADING_DOT so that we will output another ed-command
                     * later to change the double dot into a single dot.
                     */

                    if (".".equals(file1[i]))
                    {
                        outfile.println("..");
                        outfile.println(".");
                        /* Now change that double dot to the desired single dot. */
                        outfile.println(i - first1 + first0 + 1
                                + "s/^\\.\\././");
                        inserting = false;
                    }
                    else
                        /* Line is not `.', so output it unmodified. */
                        print_1_line("", file1[i]);
                }

                /* End insert mode, if we are still in it. */
                if (inserting)
                    outfile.println(".");
            }
        }

