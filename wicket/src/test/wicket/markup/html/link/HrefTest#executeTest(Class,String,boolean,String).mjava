	/**
	 * @param pageClass
	 * @param filename
	 * @param stripWicketTag
	 * @param namespace
	 * @throws Exception
	 */
	public void executeTest(final Class pageClass, final String filename, 
	        final boolean stripWicketTag, final String namespace) throws Exception
	{
		application = new MockWebApplication(null);
		application.getPages().setHomePage(pageClass);
		application.getSettings().setStripWicketTags(stripWicketTag);

		if (namespace != null)
		{
		    application.getSettings().setWicketNamespace(namespace);
		}
		
		// Do the processing
		application.setupRequestAndResponse();
		application.processRequestCycle();

		// Validate the document
		String document = application.getServletResponse().getDocument();
		log.info(document);

		assertTrue(DiffUtil.validatePage(document, this.getClass(), filename));
	}

