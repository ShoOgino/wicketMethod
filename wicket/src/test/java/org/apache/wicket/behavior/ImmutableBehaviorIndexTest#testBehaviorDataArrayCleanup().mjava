	/**
	 * Tests that removal of behaviors properly cleans up the data array
	 */
	public void testBehaviorDataArrayCleanup()
	{
		IBehavior border = new SimpleAttributeModifier("class", "border");
		IBehavior border2 = new SimpleAttributeModifier("class2", "border");
		IBehavior auto = new SimpleAttributeModifier("autocomplete", "off");
		IBehavior auto2 = new SimpleAttributeModifier("autocomplete2", "off");
		IBehavior link = new LinkBehavior("href");
		IBehavior link2 = new LinkBehavior("onclick");

		MyPage page = new MyPage();
		page.getContainer().add(border, auto, link, border2, link2, auto2);

		List<? extends IBehavior> behaviors = page.getContainer().getBehaviorsRawList();
		assertEquals(6, behaviors.size());

		// test removal of various behaviors and make sure they preserve indexes as long as there is
		// a IBehaviorListener in the list

		// border,auto,link,border2,link2,auto2
		page.getContainer().remove(border);
		behaviors = page.getContainer().getBehaviorsRawList();
		assertEquals(6, behaviors.size());
		assertNull(behaviors.get(0));

		// null,auto,link,border2,link2,auto2
		page.getContainer().remove(link);
		behaviors = page.getContainer().getBehaviorsRawList();
		assertEquals(6, behaviors.size());
		assertNull(behaviors.get(0));
		assertNull(behaviors.get(2));

		// null,auto,null,border2,link2,auto2
		page.getContainer().remove(auto2);
		behaviors = page.getContainer().getBehaviorsRawList();
		assertEquals(5, behaviors.size());
		assertNull(behaviors.get(0));
		assertNull(behaviors.get(2));

		// null,auto,null,border2,link2
		page.getContainer().remove(link2); // last IBehaviorListener
		behaviors = page.getContainer().getBehaviorsRawList();
		assertEquals(2, behaviors.size());
		assertSame(auto, behaviors.get(0));
		assertSame(border2, behaviors.get(1));

	}

