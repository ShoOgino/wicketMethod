	public void testRender1()
	{
		// Store current ThreadContext
		ThreadContext context = ThreadContext.getAndClean();
		
		// Create MockApplication
		MockApplication app = new MockApplication();
		app.setName("TestApplication1");
		app.set(); // set it to ThreadContext
		app.initApplication();

		// Mount the test page
		app.registerEncoder(new MountedMapper("first-test-page", Page1.class));

		// Construct request for first-test-page
		Request request = new MockRequest(Url.parse("first-test-page"));
		Response response = new StringResponse();

		// create and execute request cycle
		MockRequestCycle cycle = (MockRequestCycle) app.createRequestCycle(request, response);
		cycle.processRequestAndDetach();
		
		System.out.println("Rendered:");
		System.out.println(response);
		
		// invoke listener on the page		
		request = new MockRequest(Url.parse("wicket/page?0-1.ILinkListener-link"));
		response = new StringResponse();
		cycle = (MockRequestCycle) app.createRequestCycle(request, response);
		cycle.processRequestAndDetach();
		
		// invoke the listener again - without parsing the URL
		cycle = (MockRequestCycle) app.createRequestCycle(request, response);
		cycle.forceRequestHandler(new ListenerInterfaceRequestHandler(new PageAndComponentProvider(0, null, "link"), ILinkListener.INTERFACE));
		cycle.processRequestAndDetach();
		
		// cleanup
		app.destroy();
		ThreadContext.restore(context);
	}

