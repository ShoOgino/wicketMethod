	/**
	 * @see wicket.validation.IValidationError#getErrorMessage(wicket.validation.IMessageSource)
	 */
	@SuppressWarnings("unchecked")
	public final String getErrorMessage(IMessageSource messageSource)
	{
		String errorMessage = null;

		// try any message keys ...
		for (String key : keys)
		{
			errorMessage = messageSource.getMessage(key);
			if (errorMessage != null)
			{
				break;
			}
		}

		// ... if no keys matched try the default
		if (errorMessage == null && this.message != null)
		{
			errorMessage = this.message;
		}

		// if a message was found perform variable substitution
		if (errorMessage != null)
		{
			final Map<String, Object> p = (vars == null) ? Collections.EMPTY_MAP : vars;
			errorMessage = messageSource.substitute(errorMessage, p);
		}
		return errorMessage;
	}

