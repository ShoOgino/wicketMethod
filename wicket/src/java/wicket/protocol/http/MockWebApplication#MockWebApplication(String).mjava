    /**
     * Create the mock http application that can be used for testing.
     * 
     * @param path
     *            The absolute path on disk to the web application contents
     *            (e.g. war root) - may be null
     * @see wicket.protocol.http.MockServletContext
     */
    public MockWebApplication(final String path)
    {   
        Application.set(this);
        context = new MockServletContext(this, path);
        servletSession = new MockHttpSession(context);
        servletRequest = new MockHttpServletRequest(this, servletSession, context);
        servletResponse = new MockHttpServletResponse();
        // TODO adouma: check if the next line can be replaced by the following two        
        // wicketSession = getSession(servletRequest);
		wicketRequest = newWebRequest(servletRequest);
        wicketSession = getSession(wicketRequest, true);
        ApplicationSettings settings = getSettings();
        settings.setRenderStrategy(ApplicationSettings.ONE_PASS_RENDER);
    }

