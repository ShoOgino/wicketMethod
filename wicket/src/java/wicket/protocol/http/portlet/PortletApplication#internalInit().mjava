	/**
	 * THIS METHOD IS NOT PART OF THE WICKET PUBLIC API. DO NOT CALL IT.
	 * 
	 * Internal intialization. First determine the deployment mode. First check
	 * the system property -Dwicket.configuration. If it does not exist check
	 * the portlet init parameter (
	 * <code>&lt;init-param&gt&lt;param-name&gt;configuration&lt;/param-name&gt;</code>).
	 * If not found check the portlet context init paramer
	 * <code>&lt;context-param&gt&lt;param-name6gt;configuration&lt;/param-name&gt;</code>).
	 * If the parameter is "development" (which is default), settings
	 * appropriate for development are set. If it's "deployment" , deployment
	 * settings are used. If development is specified and a "sourceFolder" init
	 * parameter is also set, then resources in that folder will be polled for
	 * changes.
	 */
	protected void internalInit()
	{
		super.internalInit();

		// Set default error pages for portlets
		getApplicationSettings().setPageExpiredErrorPage(PageExpiredPortletPage.class);
		getApplicationSettings().setInternalErrorPage(InternalErrorPortletPage.class);
		getApplicationSettings().setAccessDeniedPage(AccessDeniedPortletPage.class);


		// Add resolver for automatically resolving HTML links
		getPageSettings().addComponentResolver(new AutoLinkResolver());

		// Set resource finder to portlet app path
		getResourceSettings().setResourceFinder(
				new PortletApplicationPath(portlet.getPortletContext()));

		String contextPath = portlet.getInitParameter(Application.CONTEXTPATH);
		if (contextPath != null)
		{
			getApplicationSettings().setContextPath(contextPath);
		}

		// Check if system property -Dwicket.configuration exists
		String configuration = null;
		try
		{
			configuration = System.getProperty("wicket." + Application.CONFIGURATION);
		}
		catch (SecurityException e)
		{
			// ignore; it is not allowed to read system properties
		}

		// If no system parameter check portlet specific <init-param>
		if (configuration == null)
		{
			configuration = portlet.getInitParameter(Application.CONFIGURATION);
		}
		// If no system parameter and not <init-param>, than check
		// <context-param>
		if (configuration == null)
		{
			configuration = portlet.getPortletContext().getInitParameter(Application.CONFIGURATION);
		}

		// Development mode is default if not settings have been found
		if (configuration != null)
		{
			configure(configuration, portlet.getInitParameter("sourceFolder"));
		}
		else
		{
			configure(Application.DEVELOPMENT, portlet.getInitParameter("sourceFolder"));
		}
	}

