	/**
	 * Create a new markup filter chain and initialize with all default filters
	 * required.
	 * 
	 * @param tagList
	 *            A list which the handler may add new MarkupElement to which
	 *            were not found in the markup file.
	 * @return a preconfigured markup filter chain
	 */
	private final IMarkupFilter newFilterChain(final List<ComponentTag> tagList)
	{
		// Chain together all the different markup filters and configure them
		IMarkupFilter filter = new WicketTagIdentifier(markup, xmlParser);

		filter = new TagTypeHandler(filter);
		filter = new HtmlHandler(filter);
		filter = new WicketRemoveTagHandler(filter);
		filter = new WicketLinkTagHandler(filter);
		filter = new WicketNamespaceHandler(filter, markup);

		// Provided the wicket component requesting the markup is known ...
		MarkupResourceStream resource = markup.getResource();
		if (resource != null) 
		{
			final ContainerInfo containerInfo = resource.getContainerInfo();
			if (containerInfo != null)
			{
				if (WicketMessageTagHandler.enable)
				{
					filter = new WicketMessageTagHandler(filter, containerInfo);
				}
	
				filter = new BodyOnLoadHandler(filter);
	
				// Pages require additional handlers
				if (Page.class.isAssignableFrom(containerInfo.getContainerClass()))
				{
					filter = new HtmlHeaderSectionHandler(tagList, filter);
				}
				
				filter = new HeadForceTagIdHandler(filter, containerInfo.getContainerClass());
			}
		}

		return filter;
	}

