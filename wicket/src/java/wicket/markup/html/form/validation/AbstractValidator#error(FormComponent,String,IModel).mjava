	/**
	 * Returns a formatted validation error message for a given component. The
	 * error message is retrieved from a message bundle associated with the page
	 * in which this validator is contained using the given resource key. The
	 * resourceModel is used for variable interpolation.
	 * 
	 * @param formComponent
	 *            form component
	 * @param resourceKey
	 *            The resource key to use
	 * @param resourceModel
	 *            The model for variable interpolation
	 */
	public void error(final FormComponent formComponent, final String resourceKey,
			final IModel resourceModel)
	{
		// Return formatted error message
		Localizer localizer = formComponent.getLocalizer();

		// Get the property value associated with the key.
		
		// Note: It is important that the default value of "" is provided
		// to getString() not to throw a MissingResourceException or to 
		// return a default string like "[Warning: String ..." 
		String message = localizer.getString(resourceKey, formComponent.getParent(), 
				resourceModel, "");
		
		// If not found, than ..
		if (Strings.isEmpty(message))
		{
			// Have a 2nd try with the class name as the key. This makes for
			// keys like "RequiredValidator" in any of the properties files
			// along the path.
			
			// Note: It is important that the default value of "" is NOT provided
			// to getString() throw either MissingResourceException or to to 
			// return a default string like "[Warning: String ..." in case the
			// property could not be found.
			String key = Classes.simpleName(getClass());
			message = localizer.getString(key, formComponent.getParent(), resourceModel);
		}
		formComponent.error(message);
	}

