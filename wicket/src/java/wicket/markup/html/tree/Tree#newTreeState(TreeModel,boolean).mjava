	/**
	 * Creates a new tree state by creating a new {@link TreeState}object,
	 * which is then set as the current tree state, creating a new
	 * {@link TreeSelectionModel}and then calling setTreeModel with this
	 * @param model the model that the new tree state applies to
	 * @param rootVisible whether the tree node should be displayed
	 * @return the tree state
	 */
	protected final TreeState newTreeState(final TreeModel model, boolean rootVisible)
	{
		TreeState treeStateCache = new TreeState();
		TreeSelectionModel selectionModel = new DefaultTreeSelectionModel();
		selectionModel.setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
		treeStateCache.setModel(model);
		treeStateCache.setSelectionModel(selectionModel);
		treeStateCache.setRootVisible(rootVisible);
		model.addTreeModelListener(treeStateCache);
		return treeStateCache;
	}

