	@Override
	public IWebSocketConnection sendMessage(byte[] message, int offset, int length)
		throws IOException
	{
		checkClosed();

		FutureCallback<Void> waiter = new FutureCallback<Void>();
		connection.write(null, new Callback.Empty<Void>(), message, offset, length);
		waitForMessageSent(waiter);
		return this;
	}

