		/**
		 * Attempts to read more data.
		 * 
		 * @return Number of available bytes
		 * @throws IOException
		 *             An I/O error occurred.
		 */
		private int makeAvailable() throws IOException
		{
			if (pos != -1)
			{
				return 0;
			}

			// Move the data to the beginning of the buffer.
			total += tail - head - pad;
			System.arraycopy(buffer, tail - pad, buffer, 0, pad);

			// Refill buffer with new data.
			head = 0;
			tail = pad;

			for (;;)
			{
				int bytesRead = input.read(buffer, tail, bufSize - tail);
				if (bytesRead == -1)
				{
					// The last pad amount is left in the buffer.
					// Boundary can't be in there so signal an error
					// condition.
					final String msg = "Stream ended unexpectedly";
					throw new MalformedStreamException(msg);
				}
				if (notifier != null)
				{
					notifier.noteBytesRead(bytesRead);
				}
				tail += bytesRead;

				findSeparator();
				int av = available();

				if ((av > 0) || (pos != -1))
				{
					return av;
				}
			}
		}

