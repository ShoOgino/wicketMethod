	/**
	 * Validate scheme. If schemes[] was initialized to a non null, then only
	 * those scheme's are allowed. Note this is slightly different than for the
	 * constructor.
	 * 
	 * @param scheme
	 *            The scheme to validate. A <code>null</code> value is
	 *            considered invalid.
	 * @return true if valid.
	 */
	protected boolean isValidScheme(String scheme)
	{
		if (scheme == null)
		{
			return false;
		}

		if (!Pattern.compile(SCHEME_PATTERN).matcher(scheme).matches())
		{
			return false;
		}

		if (isOff(ALLOW_ALL_SCHEMES))
		{

			if (!this.allowedSchemes.contains(scheme))
			{
				return false;
			}
		}

		return true;
	}

