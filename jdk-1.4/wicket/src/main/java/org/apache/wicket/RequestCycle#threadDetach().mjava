	/**
	 * Releases the current thread local related resources. The threadlocal of this request cycle is
	 * reset. If we are in a 'redirect' state, we do not want to lose our messages as - e.g. when
	 * handling a form - there's a fat chance we are coming back for the rendering of it.
	 */
	private final void threadDetach()
	{
		// Detach from session
		if (sessionExists())
		{
			try
			{
				getSession().detach();
			}
			catch (RuntimeException re)
			{
				log.error("there was an error detaching the session", re);
			}
		}

		if (isRedirect())
		{
			// Since we are explicitly redirecting to a page already, we do not
			// want a second redirect to occur automatically
			setRedirect(false);
		}

		// Clear ThreadLocal reference; makes sense as this object should not be
		// reused
		current.set(null);
	}

