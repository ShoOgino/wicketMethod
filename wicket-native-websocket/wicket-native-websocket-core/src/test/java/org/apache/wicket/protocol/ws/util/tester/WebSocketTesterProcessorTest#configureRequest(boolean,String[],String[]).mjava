    protected void configureRequest(boolean protectionNeeded, String[] allowedDomains, String[] origins) {
        WebSocketSettings webSocketSettings = WebSocketSettings.Holder.get(application);
        webSocketSettings.setHijackingProtectionEnabled(protectionNeeded);
        webSocketSettings.setAllowedDomains(Arrays.asList(allowedDomains));
        MockHttpServletRequest request = tester.getRequest();
        for (String origin : origins) {
            request.addHeader("Origin", origin);
        }
        request.addParameter("resourceName", TestWebSocketResource.TEXT);
        request.addParameter(WebRequest.PARAM_AJAX_BASE_URL, ".");
    }

