	@Override
	public void onOpen(Session session, EndpointConfig endpointConfig)
	{
		WebApplication app = (WebApplication) session.getUserProperties().get(JavaxWebSocketFilter.APPLICATION_KEY);

		try
		{
			ThreadContext.setApplication(app);
			javaxWebSocketProcessor = new JavaxWebSocketProcessor(session, app);
		}
		finally
		{
			ThreadContext.detach();
		}

	}

