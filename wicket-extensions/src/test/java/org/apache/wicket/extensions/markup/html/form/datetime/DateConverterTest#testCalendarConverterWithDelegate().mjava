	/**
	 * WICKET-3658
	 */
	@Test
	public void testCalendarConverterWithDelegate()
	{
		Locale locale = Locale.GERMAN;

		Calendar input = Calendar.getInstance(locale);
		input.clear();
		input.set(2011, Calendar.MAY, 7);

		final StyleZonedDateTimeConverter styleDateConverter = new StyleZonedDateTimeConverter("F-", false);

		CalendarConverter calendarConverter = new CalendarConverter(new IConverter<Date>()
		{
			private static final long serialVersionUID = 1L;

			@Override
			public Date convertToObject(String value, Locale locale) throws ConversionException {
				ZonedDateTime zd = styleDateConverter.convertToObject(value, locale);
				return zd == null ? null : Date.from(zd.toInstant());
			}

			@Override
			public String convertToString(Date value, Locale locale) {
				return styleDateConverter.convertToString(ZonedDateTime.ofInstant(value.toInstant(), ZoneId.systemDefault()), locale);
			}
			
		});

		String expected = styleDateConverter.convertToString(ZonedDateTime.ofInstant(input.toInstant(), ZoneId.systemDefault()), locale);
		String actual = calendarConverter.convertToString(input, locale);

		Assert.assertEquals(expected, actual);

		Calendar revert = calendarConverter.convertToObject(actual, locale);

		Assert.assertEquals(input, revert);
	}

