	/** Tests whitelisting with conflicting subdomain origin when sec-fetch-site is cross-site. */
	@Test
	void crossSiteButWhitelistedSubdomainOriginAllowed()
	{
		csrfListener.addAcceptedOrigin("example.com");

		tester.addRequestHeader(WebRequest.HEADER_ORIGIN, "http://foo.example.com/");
		tester.addRequestHeader(SEC_FETCH_SITE_HEADER, CROSS_SITE);

		tester.clickLink("link");

		tester.assertRenderedPage(SecondPage.class);
		assertOriginsWhitelisted();
	}

