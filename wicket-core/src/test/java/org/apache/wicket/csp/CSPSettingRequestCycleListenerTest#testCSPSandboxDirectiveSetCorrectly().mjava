	@Test
	public void testCSPSandboxDirectiveSetCorrectly()
	{
		CSPSettingRequestCycleListener cspListener =
			new CSPSettingRequestCycleListener(tester.getApplication());
		final int cspSandboxDirectiveValueCount = CSPDirectiveSandboxValue.values().length;
		for (int i = 0; i < cspSandboxDirectiveValueCount; i++)
		{
			final CSPDirectiveSandboxValue cspDirectiveValue = CSPDirectiveSandboxValue.values()[i];
			if (cspDirectiveValue.equals(CSPDirectiveSandboxValue.EMPTY))
				continue;

			cspListener.blocking().addDirective(SANDBOX, cspDirectiveValue);
			cspListener.reporting().addDirective(SANDBOX, cspDirectiveValue);
		}

		StringBuffer headerErrors = checkHeaders(cspListener);

		if (headerErrors.length() > 0)
		{
			Assertions.fail(headerErrors.toString());
		}
	}

