	public void testPageProperties_stored()
	{
		TestMapperContext mapperContext = new TestMapperContext();
		Page page = new TestPage();
		mapperContext.getPageManager().touchPage(page);
		mapperContext.getPageManager().commitRequest();

		// by cleaning session cache we make sure of not being testing the same in-memory instance
		mapperContext.cleanSessionCache();

		PageProvider provider = mapperContext.new TestPageProvider(page.getPageId(), 0);

		// no instance yet
		assertFalse(provider.hasPageInstance());
		try
		{
			provider.isPageInstanceFresh();
			fail("expected illegal state exception");
		}
		catch (IllegalStateException e)
		{
			// expected
		}

		provider.getPageInstance();

		assertTrue(provider.hasPageInstance());
		assertFalse(provider.isPageInstanceFresh());
	}

