	@Override
	public void render(HeaderItem item)
	{
		while (item instanceof IWrappedHeaderItem)
		{
			item = ((IWrappedHeaderItem)item).getWrapped();
		}

		if (item instanceof AbstractCspHeaderItem)
		{
			if (policyRendered == false)
			{
				policyRendered = true;

				String policy = getContentSecurityPolicy(nonce);

				super.render(MetaDataHeaderItem.forHttpEquiv(CONTENT_SECURITY_POLICY, policy));
			}

			((AbstractCspHeaderItem)item).setNonce(nonce);
		}
		
		super.render(item);
	}

