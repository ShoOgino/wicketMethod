	@Override
	public void onRequestHandlerResolved(RequestCycle cycle, IRequestHandler handler)
	{
		WebResponse webResponse = (WebResponse) cycle.getResponse();
		configs.values().stream().filter(CSPConfiguration::isSet).forEach(config -> {
			String headerValue = config.renderHeaderValue(cycle);
			webResponse.setHeader(config.getMode().getHeader(), headerValue);
			if (config.isAddLegacyHeaders())
				webResponse.setHeader(config.getMode().getLegacyHeader(), headerValue);
		});
	}

