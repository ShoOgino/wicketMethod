	public String sanitizeRequest(String filename, PageParameters parameters)
	{
		int pos = filename.lastIndexOf('.');

		final String fullname = pos == -1 ? filename : filename.substring(0, pos);
		final String extension = pos == -1 ? null : filename.substring(pos);

		pos = fullname.lastIndexOf(timestampPrefix);

		if (pos != -1)
		{
			final String timestamp = fullname.substring(pos + timestampPrefix.length());
			final String basename = fullname.substring(0, pos);

			try
			{
				Long.parseLong(timestamp); // just check the timestamp is numeric

				// create filename without timestamp for resource lookup
				return extension == null ? basename : basename + extension;
			}
			catch (NumberFormatException e)
			{
				// some strange case of coincidence where the filename contains the timestamp prefix
				// but the timestamp itself is non-numeric - we interpret this situation as
				// "file has no timestamp"
			}
		}
		return filename;
	}

