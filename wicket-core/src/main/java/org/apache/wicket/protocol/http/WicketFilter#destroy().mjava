	/**
	 * @see javax.servlet.Filter#destroy()
	 */
	public void destroy()
	{
		if (application != null)
		{
			try
			{
				ThreadContext.setApplication(application);
				application.internalDestroy();
			}
			finally
			{
				ThreadContext.detach();
				application = null;
			}
		}

		if (applicationFactory != null)
		{
			if (applicationFactory instanceof IDestroyableWebApplicationFactory)
			{
				((IDestroyableWebApplicationFactory)applicationFactory).destroy();
			}
		}
	}

